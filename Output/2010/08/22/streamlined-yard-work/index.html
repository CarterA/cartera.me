<!DOCTYPE HTML>
<!--
	Well hello there! Feel free to look over the code here, if you'd like.
	It is worth mentioning that the un-compiled version of the site's code
	can be found here:  http://github.com/CarterA/cartera.me/
-->
<html>
	<head>
		
		<meta charset="utf-8">
		<title>Carter Allen - Streamlined Yard Work</title>
		<meta name="description" content="Articles and projects written and created by developer Carter Allen.">
		<meta name="author" content="Carter Allen">
		<link rel="alternate" type="application/atom+xml" title="Carter Allen - Feed" href="http://feeds.feedburner.com/CarterADotMeBlog?format=xml">
		<link rel="openid.server" href="http://www.myopenid.com/server" />
		<link rel="openid.delegate" href="http://carterallen.myopenid.com/" />
		<link rel="openid2.local_id" href="http://carterallen.myopenid.com" />
		<link rel="openid2.provider" href="http://www.myopenid.com/server" />
		
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" href="/stylesheets/main.css">
		
        
		<link rel="stylesheet" href="/stylesheets/post.css">
		
		
	</head>
	<body>
	    <div id="container">
		<header>
		    <div class="badtie"></div>
			<a href="/">
				<img id="logo" src="/images/hat.png" width=190 height=100>
				<p id="logotype">carter<b>allen</b></p>
			</a>
			<nav>
			  <ul>
				<li><a href="/">Articles</a></li>
				<li><a href="/projects">Projects</a></li>
				<li><a href="/archives">Archives</a></li>
				<li><a href="/about/" rel="author">About</a></li>
			  </ul>
			</nav>
		</header>
		<section id ="content"><!-- Stylesheets: post -->
<article class="post">
	<header class="post-header">
		<h1>Streamlined Yard Work</h1>
		<span class="date">Aug 22, 2010</span>
	</header>
	<section class="post-content">
		<p>In my <a href="/2010/08/12/about-this-website/">recent article</a> describing the system that powers this website, I discussed some &quot;yard work&quot;. I use this term to refer to tasks that I accomplish using Ruby&#39;s <a href="http://rake.rubyforge.org/">Rake</a>. Since I published that article, I&#39;ve made several improvements to the Rakefile that powers most of my website&#39;s common operations. As such, I figured that I&#39;d post a more in-depth description of the lovely scripting solution that I&#39;ve come up with.  </p>

<p>To begin, I wanted to make the output from the Rake tasks more stylish and readable. I took inspiration from <a href="http://mxcl.github.com/homebrew/">Homebrew</a>, and wrote this function:</p>

<script src="https://gist.github.com/1257914.js?file=printHeader.rb"></script>

<p>This depends on the excellent <code>term-ansicolor</code> gem, and produces command-line output that looks something like this: <img src="/images/posts/2010-08-22-streamlined-yard-work/sampleHeader.png" alt="Compiling website...">. It distinguishes itself from the other command line output, so that you&#39;re instantly drawn to the more important text (the headers). Of course, this would mean nothing if I didn&#39;t use it.  </p>

<p>The default rake task is set to <code>develop</code>. This is the task I run whenever I&#39;d like to work on the site locally, preview an article as I write it, or test any new features without deploying them to the server. Here, take a look:</p>

<script src="https://gist.github.com/1257914.js?file=rakeTasks.rb"></script>

<p>Don&#39;t worry:  I can hear you yelling and screaming. You thought this was going to be simple. Ha! The develop task basically re-implements a lot of the things that the <code>jekyll</code> command line utility usually does. I did that so that I could control the output and the order in which code was executed. First off, the <code>develop</code> task runs the <code>build</code> task. The build task simply creates a generic Jekyll site object and processes it, forcing it to use the <code>_config.yml</code> that resides in my site&#39;s directory. The <code>site</code> object is kept around so that I can re-use it each time a file gets changed.  </p>

<p>The <code>develop</code> task then starts up a directory watcher, which monitors the source directory for any changes. Whenever a file is changed, the site is re-processed so that the files in the <code>_site</code> directory are always current. Currently, it processes the entire site again whenever a file is changed, which I&#39;m sure is extraordinarily inefficient. If you have any idea how to make Jekyll only re-process the changed files, I&#39;d love to know.  </p>

<p>After the site is built and the watcher is running smoothly, a web server is started. I&#39;m using the <code>WEBrick</code> web server (comes with Ruby), mostly because of how easy it is to configure. I considered using <a href="http://code.macournoyer.com/thin/">Thin</a>, but it requires I use an adapter like Rack, which seemed unnecessary when I was simply serving static files. I have the server configured to only log errors to the console, which is important:  it keeps my command line clean, unless there is an actual issue. This is easy to modify if you want to actually see your access log, but I don&#39;t. The server spins up, the website opens in the default browser, and yet another header is printed.  </p>

<p>See? That wasn&#39;t so complicated after all!  </p>

<p>The <code>deploy</code> has actually stayed pretty much the same (with the exception of headers) since the first post about it, so I won&#39;t go into it here. If you&#39;re interested in using this Rakefile in your own project, feel free to <a href="http://github.com/CarterA/cartera.me/blob/master/Rakefile.rb">check it out on GitHub</a>.</p>

	</section>
	<section class="comments">
		<div id="disqus_thread"></div>
		<script src="http://disqus.com/forums/cartera/embed.js"></script>
		<noscript><a href="http://cartera.disqus.com/?url=ref">View the discussion thread.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
	</section>
</article></section>
		<footer>
			<p>Site revision <a href="http://github.com/CarterA/cartera.me/tree/"></a>. Valid <a href="http://validator.w3.org/check?uri=referer" target="_blank">HTML5</a>.</p>
			<p>Copyright 2010 Carter Allen</p>
			<div class="badtie"></div>
		</footer>
		</div>
	</body>
</html>